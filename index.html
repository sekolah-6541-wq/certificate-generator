<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2685.1">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; min-height: 14.0px}
  </style>
</head>
<body>
<p class="p1">&lt;!doctype html&gt;</p>
<p class="p1">&lt;html lang="ms"&gt;</p>
<p class="p1">&lt;head&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;meta charset="utf-8" /&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;meta name="viewport" content="width=device-width,initial-scale=1" /&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;title&gt;Jana Sijil - Muat Turun Segera&lt;/title&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;style&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>body { font-family: Arial, sans-serif; text-align:center; padding:24px; background:#f5f6f8; color:#222; }</p>
<p class="p1"><span class="Apple-converted-space">    </span>h1 { margin-bottom:6px; }</p>
<p class="p1"><span class="Apple-converted-space">    </span>form { margin:18px 0; }</p>
<p class="p1"><span class="Apple-converted-space">    </span>input[type="text"] { padding:10px; width:320px; font-size:16px; margin:6px 0; }</p>
<p class="p1"><span class="Apple-converted-space">    </span>button { padding:10px 18px; font-size:16px; cursor:pointer; }</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>/* certificate container (kept off-screen but visible for html2canvas) */</p>
<p class="p1"><span class="Apple-converted-space">    </span>#certificate {</p>
<p class="p1"><span class="Apple-converted-space">      </span>width:1600px; /* match your image width */</p>
<p class="p1"><span class="Apple-converted-space">      </span>height:1125px; /* match your image height */</p>
<p class="p1"><span class="Apple-converted-space">      </span>position: absolute;</p>
<p class="p1"><span class="Apple-converted-space">      </span>left: -9999px; /* off-screen but still rendered */</p>
<p class="p1"><span class="Apple-converted-space">      </span>top: -9999px;</p>
<p class="p1"><span class="Apple-converted-space">      </span>display: block;</p>
<p class="p1"><span class="Apple-converted-space">      </span>background: #fff;</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>#cert-bg {</p>
<p class="p1"><span class="Apple-converted-space">      </span>width:100%;</p>
<p class="p1"><span class="Apple-converted-space">      </span>height:100%;</p>
<p class="p1"><span class="Apple-converted-space">      </span>object-fit:cover;</p>
<p class="p1"><span class="Apple-converted-space">      </span>display:block;</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>/* Text overlays - center them. Adjust top values to match your layout. */</p>
<p class="p1"><span class="Apple-converted-space">    </span>.overlay {</p>
<p class="p1"><span class="Apple-converted-space">      </span>position: absolute;</p>
<p class="p1"><span class="Apple-converted-space">      </span>width: 100%;</p>
<p class="p1"><span class="Apple-converted-space">      </span>text-align: center;</p>
<p class="p1"><span class="Apple-converted-space">      </span>color: #111;</p>
<p class="p1"><span class="Apple-converted-space">      </span>letter-spacing: 0.5px;</p>
<p class="p1"><span class="Apple-converted-space">      </span>text-shadow: 0 1px 0 rgba(255,255,255,0.6);</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>#cert-name {</p>
<p class="p1"><span class="Apple-converted-space">      </span>top: 450px; /* adjust: vertical position of name */</p>
<p class="p1"><span class="Apple-converted-space">      </span>font-size: 70px; /* adjust size */</p>
<p class="p1"><span class="Apple-converted-space">      </span>font-weight: 700;</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>#cert-id {</p>
<p class="p1"><span class="Apple-converted-space">      </span>top: 540px; /* adjust */</p>
<p class="p1"><span class="Apple-converted-space">      </span>font-size: 36px; /* adjust */</p>
<p class="p1"><span class="Apple-converted-space">      </span>font-weight: 500;</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>/* small helper note */</p>
<p class="p1"><span class="Apple-converted-space">    </span>.note { color:#555; margin-top:8px; font-size:14px; }</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;/style&gt;</p>
<p class="p1">&lt;/head&gt;</p>
<p class="p1">&lt;body&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;h1&gt;Jana Sijil Anda&lt;/h1&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;p&gt;Isi Nama &amp; No. K/P — sijil akan dimuat turun secara automatik.&lt;/p&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;form id="certForm" onsubmit="generateCert(event)"&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;input id="name" type="text" placeholder="Nama Penuh" required /&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;input id="idno" type="text" placeholder="No. K/P" required /&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div style="margin-top:10px"&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;button type="submit"&gt;Jana &amp; Muat Turun Sijil&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div class="note"&gt;Sijil akan dimuat turun sebagai PDF. Nama akan digunakan sebagai nama fail.&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;/form&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;!-- OFF-SCREEN certificate (render target for html2canvas) --&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;div id="certificate" aria-hidden="true"&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;img id="cert-bg" src="cert-template.png" alt="Certificate background" /&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div id="cert-name" class="overlay"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div id="cert-id" class="overlay"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;!-- libs --&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"&gt;&lt;/script&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"&gt;&lt;/script&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;script&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>// sanitize filename</p>
<p class="p1"><span class="Apple-converted-space">    </span>function sanitizeFilename(s) {</p>
<p class="p1"><span class="Apple-converted-space">      </span>return s.replace(/[^\w\s-]/gi, '').replace(/\s+/g, '_').trim();</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>// main generate function</p>
<p class="p1"><span class="Apple-converted-space">    </span>async function generateCert(ev) {</p>
<p class="p1"><span class="Apple-converted-space">      </span>ev.preventDefault();</p>
<p class="p1"><span class="Apple-converted-space">      </span>const name = document.getElementById('name').value.trim();</p>
<p class="p1"><span class="Apple-converted-space">      </span>const idno = document.getElementById('idno').value.trim();</p>
<p class="p1"><span class="Apple-converted-space">      </span>if (!name || !idno) { alert('Sila isi Nama dan No. K/P'); return; }</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>// populate overlays</p>
<p class="p1"><span class="Apple-converted-space">      </span>document.getElementById('cert-name').innerText = name;</p>
<p class="p1"><span class="Apple-converted-space">      </span>document.getElementById('cert-id').innerText = 'No. K/P: ' + idno;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>// element to render</p>
<p class="p1"><span class="Apple-converted-space">      </span>const certEl = document.getElementById('certificate');</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>// ensure background image is loaded before rendering</p>
<p class="p1"><span class="Apple-converted-space">      </span>const bgImg = document.getElementById('cert-bg');</p>
<p class="p1"><span class="Apple-converted-space">      </span>if (!bgImg.complete) {</p>
<p class="p1"><span class="Apple-converted-space">        </span>await new Promise((res, rej) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">          </span>bgImg.onload = res;</p>
<p class="p1"><span class="Apple-converted-space">          </span>bgImg.onerror = () =&gt; rej('Gagal memuat gambar sijil. Pastikan cert-template.png wujud.');</p>
<p class="p1"><span class="Apple-converted-space">        </span>});</p>
<p class="p1"><span class="Apple-converted-space">      </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>try {</p>
<p class="p1"><span class="Apple-converted-space">        </span>// render to canvas (scale for high quality)</p>
<p class="p1"><span class="Apple-converted-space">        </span>const scale = 2; // increase for higher DPI</p>
<p class="p1"><span class="Apple-converted-space">        </span>const canvas = await html2canvas(certEl, {</p>
<p class="p1"><span class="Apple-converted-space">          </span>scale: scale,</p>
<p class="p1"><span class="Apple-converted-space">          </span>useCORS: true,</p>
<p class="p1"><span class="Apple-converted-space">          </span>allowTaint: false,</p>
<p class="p1"><span class="Apple-converted-space">          </span>logging: false</p>
<p class="p1"><span class="Apple-converted-space">        </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Create PDF from canvas using jsPDF</p>
<p class="p1"><span class="Apple-converted-space">        </span>const { jsPDF } = window.jspdf;</p>
<p class="p1"><span class="Apple-converted-space">        </span>// We will create PDF with same pixel dimensions (unit px) so no rescaling surprises</p>
<p class="p1"><span class="Apple-converted-space">        </span>const pdf = new jsPDF({</p>
<p class="p1"><span class="Apple-converted-space">          </span>orientation: (canvas.width &gt; canvas.height) ? 'landscape' : 'portrait',</p>
<p class="p1"><span class="Apple-converted-space">          </span>unit: 'px',</p>
<p class="p1"><span class="Apple-converted-space">          </span>format: [canvas.width, canvas.height]</p>
<p class="p1"><span class="Apple-converted-space">        </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>const imgData = canvas.toDataURL('image/png');</p>
<p class="p1"><span class="Apple-converted-space">        </span>pdf.addImage(imgData, 'PNG', 0, 0, canvas.width, canvas.height);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// filename</p>
<p class="p1"><span class="Apple-converted-space">        </span>const filename = 'Sijil_' + sanitizeFilename(name) + '.pdf';</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// auto-download</p>
<p class="p1"><span class="Apple-converted-space">        </span>pdf.save(filename);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Optionally: you can also auto-download PNG instead (uncomment if needed)</p>
<p class="p1"><span class="Apple-converted-space">        </span>// canvas.toBlob(function(blob){</p>
<p class="p1"><span class="Apple-converted-space">        </span>// <span class="Apple-converted-space">  </span>const link = document.createElement('a');</p>
<p class="p1"><span class="Apple-converted-space">        </span>// <span class="Apple-converted-space">  </span>link.href = URL.createObjectURL(blob);</p>
<p class="p1"><span class="Apple-converted-space">        </span>// <span class="Apple-converted-space">  </span>link.download = filename.replace('.pdf', '.png');</p>
<p class="p1"><span class="Apple-converted-space">        </span>// <span class="Apple-converted-space">  </span>document.body.appendChild(link); link.click(); link.remove();</p>
<p class="p1"><span class="Apple-converted-space">        </span>// }, 'image/png');</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>} catch (err) {</p>
<p class="p1"><span class="Apple-converted-space">        </span>console.error(err);</p>
<p class="p1"><span class="Apple-converted-space">        </span>alert('Terjadi ralat semasa menjana sijil. Semak konsol devtools.');</p>
<p class="p1"><span class="Apple-converted-space">      </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;/script&gt;</p>
<p class="p1">&lt;/body&gt;</p>
<p class="p1">&lt;/html&gt;</p>
</body>
</html>
